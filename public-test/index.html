<!DOCTYPE html>
<html lang="" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>External Test Catalog</title>
  <meta name="description" content="A catalog to test external tracks.">
  <!-- Tunecamp Metadata (for community registry) -->
  <meta name="generator" content="Tunecamp 1.0.1">
  <meta name="tunecamp-title" content="External Test Catalog">
  <meta name="tunecamp-artist" content="Test Artist">
  <!-- RSS/Atom Feeds -->
  <link rel="alternate" type="application/rss+xml" title="External Test Catalog RSS Feed" href="./feed.xml">
  <link rel="alternate" type="application/atom+xml" title="External Test Catalog Atom Feed" href="./atom.xml">
  <link rel="stylesheet" href="./ assets/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    // Initialize theme from localStorage or system preference
    (function () {
      const saved = localStorage.getItem('theme');
      if (saved) {
        document.documentElement.setAttribute('data-theme', saved);
      } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>

<body>
  <!-- Top Navigation Bar - Faircamp style -->
  <nav class="top-nav">
    <a href="./ index.html" class="nav-logo">
      <svg class="logo-icon" viewBox="0 0 100 100" fill="none">
        <circle cx="50" cy="50" r="45" stroke="currentColor" stroke-width="4" />
        <circle cx="50" cy="50" r="20" fill="currentColor" />
        <circle cx="50" cy="50" r="8" fill="var(--bg-color)" />
      </svg>
      <span>Test Artist</span>
    </a>
    <div class="nav-links">
      <a href="./ index.html" class="nav-link">Browse</a>
    </div>
  </nav>

  <!-- Header with Background Image -->
  <header class="site-header">
    <div class="header-background"></div>
    <div class="header-content">
    </div>
  </header>

  <main class="site-main">
    <!-- Main Content - Two Column Layout (Faircamp style) -->
<div class="main-content">
  <div class="content-wrapper">
    <!-- Releases Grid (Left Column) -->
    <section class="releases-section">
      <div class="catalog-header">
        <h2 class="catalog-title">Test Artist</h2>
        <p class="catalog-bio">An artist for testing.</p>
      </div>

      <h3 class="section-title">Releases</h3>
      
      <!-- Search and Filter Controls -->
      <div class="releases-controls">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search releases..." autocomplete="off">
        </div>
        
        <div class="filter-controls">
          <select id="genreFilter" class="filter-select">
            <option value="">All Genres</option>
          </select>
          
          <select id="sortBy" class="filter-select">
            <option value="date-desc">Newest First</option>
            <option value="date-asc">Oldest First</option>
            <option value="title-asc">Title A-Z</option>
            <option value="title-desc">Title Z-A</option>
          </select>
        </div>
      </div>
      
      <div class="releases-grid" id="releasesGrid">
        <article class="release-card" 
                 data-title="Test Release" 
                 data-date="2026-02-22"
                 data-genres=""
                 data-description="">
          <a href="./releases/test-release/index.html" class="release-link">
            <div class="release-cover release-cover-placeholder">
              <i class="fas fa-music"></i>
            </div>
            
            <div class="release-meta">
              <h3 class="release-title">Test Release</h3>
              <p class="release-artist">Test Artist</p>
            </div>
          </a>
        </article>
      </div>
      
      <p class="no-results" id="noResults" style="display: none;">No releases match your search.</p>
    </section>

    <!-- Sidebar (Right Column) -->
    <aside class="sidebar">
      <div class="sidebar-section artist-card">
        <h2 class="sidebar-title">Test Artist</h2>
        <p class="sidebar-bio">An artist for testing.</p>
        
        <!-- Action Links -->
        <div class="sidebar-actions">
          <span class="action-link">··· More</span>
          <button class="action-link" onclick="copyPageLink()"><i class="fas fa-link"></i> Copy link</button>
          <a href="./feed.xml" class="action-link"><i class="fas fa-rss"></i> RSS Feed</a>
          <a href="./atom.xml" class="action-link"><i class="fas fa-rss-square"></i> Atom Feed</a>
          <a href="./catalog.m3u" class="action-link" download><i class="fas fa-music"></i> Playlist M3U</a>
        </div>
        
      </div>
      
      <!-- Genre Tags Cloud -->
      <div class="sidebar-section" id="genreTagsSection">
        <div class="genre-tags" id="genreTagsCloud">
          <!-- Will be populated by JS -->
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
function copyPageLink() {
  navigator.clipboard.writeText(window.location.href).then(() => {
    alert('Link copied!');
  });
}
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('searchInput');
  const genreFilter = document.getElementById('genreFilter');
  const sortBy = document.getElementById('sortBy');
  const releasesGrid = document.getElementById('releasesGrid');
  const noResults = document.getElementById('noResults');
  const genreTagsCloud = document.getElementById('genreTagsCloud');
  const genreTagsSection = document.getElementById('genreTagsSection');
  
  if (!releasesGrid) return;
  
  const releaseCards = Array.from(releasesGrid.querySelectorAll('.release-card'));
  
  // Collect all genres
  const allGenres = new Set();
  releaseCards.forEach(card => {
    const genres = card.dataset.genres;
    if (genres) {
      genres.split(',').forEach(g => allGenres.add(g.trim()));
    }
  });
  
  const sortedGenres = Array.from(allGenres).sort();
  
  // Populate genre filter dropdown
  sortedGenres.forEach(genre => {
    const option = document.createElement('option');
    option.value = genre;
    option.textContent = genre;
    genreFilter.appendChild(option);
  });
  
  // Populate genre tags cloud in sidebar
  if (genreTagsCloud && sortedGenres.length > 0) {
    sortedGenres.forEach(genre => {
      const tag = document.createElement('span');
      tag.className = 'genre-tag';
      tag.textContent = genre;
      tag.onclick = () => {
        genreFilter.value = genre;
        filterAndSort();
      };
      genreTagsCloud.appendChild(tag);
    });
  } else if (genreTagsSection) {
    genreTagsSection.style.display = 'none';
  }
  
  function filterAndSort() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedGenre = genreFilter.value;
    const sortValue = sortBy.value;
    
    // Update genre tag highlighting
    if (genreTagsCloud) {
      genreTagsCloud.querySelectorAll('.genre-tag').forEach(tag => {
        tag.classList.toggle('active', tag.textContent === selectedGenre);
      });
    }
    
    // Filter
    let visibleCards = releaseCards.filter(card => {
      const title = (card.dataset.title || '').toLowerCase();
      const description = (card.dataset.description || '').toLowerCase();
      const genres = card.dataset.genres || '';
      
      const matchesSearch = !searchTerm || 
        title.includes(searchTerm) || 
        description.includes(searchTerm);
      
      const matchesGenre = !selectedGenre || 
        genres.split(',').map(g => g.trim()).includes(selectedGenre);
      
      return matchesSearch && matchesGenre;
    });
    
    // Sort
    visibleCards.sort((a, b) => {
      switch (sortValue) {
        case 'date-desc':
          return new Date(b.dataset.date) - new Date(a.dataset.date);
        case 'date-asc':
          return new Date(a.dataset.date) - new Date(b.dataset.date);
        case 'title-asc':
          return (a.dataset.title || '').localeCompare(b.dataset.title || '');
        case 'title-desc':
          return (b.dataset.title || '').localeCompare(a.dataset.title || '');
        default:
          return 0;
      }
    });
    
    // Apply visibility and order
    releaseCards.forEach(card => {
      card.style.display = 'none';
      card.style.order = '';
    });
    
    visibleCards.forEach((card, index) => {
      card.style.display = '';
      card.style.order = index;
    });
    
    // Show/hide no results message
    if (noResults) {
      noResults.style.display = visibleCards.length === 0 ? 'block' : 'none';
    }
  }
  
  searchInput.addEventListener('input', filterAndSort);
  genreFilter.addEventListener('change', filterAndSort);
  sortBy.addEventListener('change', filterAndSort);
});
</script>


  </main>

  <footer class="site-footer">
    <div class="footer-content">
      <p>
        &copy; Test Artist -
        Powered by <a href="https://github.com/scobru/tunecamp" target="_blank">Tunecamp</a>
      </p>
    </div>
  </footer>

  <script src="./ assets/player.js"></script>

  <!-- Interactive Theme Widget -->
  <script src="./ assets/theme-widget.js"></script>

  <!-- Tunecamp Community Registry (auto-registers site) -->
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="./ assets/community-registry.js"></script>
</body>

</html>